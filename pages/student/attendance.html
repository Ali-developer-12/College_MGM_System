<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Attendance - Student | CMS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/components.css">
    <link rel="stylesheet" href="../../css/dashboard.css">
    <style>
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: 500;
        }

        .calendar-header {
            background: var(--gray-100);
            color: var(--gray-600);
            font-weight: 600;
        }

        .calendar-day.present {
            background: var(--success-light);
            color: var(--success);
        }

        .calendar-day.absent {
            background: var(--danger-light);
            color: var(--danger);
        }

        .calendar-day.late {
            background: var(--warning-light);
            color: var(--warning);
        }

        .calendar-day.holiday {
            background: var(--gray-100);
            color: var(--gray-400);
        }

        .calendar-day.empty {
            background: transparent;
        }

        .subject-attendance {
            border-left: 4px solid var(--primary);
            padding-left: var(--space-4);
            margin-bottom: var(--space-4);
        }
    </style>
</head>

<body>
    <div class="dashboard-layout">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo"><i class="bi bi-mortarboard-fill"></i></div>
                <div class="sidebar-brand">
                    <h1>CMS</h1>
                    <p>GCT Bhakkar</p>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <p class="nav-section-title">Main Menu</p>
                    <div class="nav-item"><a href="dashboard.html" class="nav-link"><i
                                class="bi bi-grid-1x2-fill"></i><span>Dashboard</span></a></div>
                    <div class="nav-item"><a href="attendance.html" class="nav-link active"><i
                                class="bi bi-calendar-check"></i><span>Attendance</span></a></div>
                    <div class="nav-item"><a href="marks.html" class="nav-link"><i
                                class="bi bi-file-earmark-text"></i><span>Marks & Grades</span></a></div>
                    <div class="nav-item"><a href="subjects.html" class="nav-link"><i
                                class="bi bi-book"></i><span>Subjects</span></a></div>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="sidebar-user">
                    <div class="avatar avatar-md" id="userAvatar">MA</div>
                    <div class="sidebar-user-info">
                        <div class="sidebar-user-name" id="userName">Muhammad Ali</div>
                        <div class="sidebar-user-role">Student</div>
                    </div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-navbar">
                <div class="navbar-left">
                    <button class="sidebar-toggle" id="sidebarToggle"><i class="bi bi-list"></i></button>
                    <div>
                        <h1 class="page-title">My Attendance</h1>
                    </div>
                </div>
                <div class="navbar-right">
                    <div class="dropdown-cms">
                        <div class="navbar-user">
                            <div class="navbar-user-name" id="navUserName">Muhammad Ali</div>
                            <div class="avatar avatar-md" id="navAvatar">MA</div>
                        </div>
                        <div class="dropdown-menu-cms">
                            <a href="#" class="dropdown-item-cms text-danger" onclick="logout()"><i
                                    class="bi bi-box-arrow-right"></i>Logout</a>
                        </div>
                    </div>
                </div>
            </header>

            <div class="page-content">
                <!-- Summary Cards -->
                <div class="stats-grid mb-4">
                    <div class="stat-card">
                        <div class="stat-icon primary"><i class="bi bi-calendar-check"></i></div>
                        <div class="stat-value text-primary">78%</div>
                        <div class="stat-label">Overall Attendance</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon success"><i class="bi bi-check-circle"></i></div>
                        <div class="stat-value">98</div>
                        <div class="stat-label">Classes Attended</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon danger"><i class="bi bi-x-circle"></i></div>
                        <div class="stat-value">26</div>
                        <div class="stat-label">Classes Missed</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon warning"><i class="bi bi-clock"></i></div>
                        <div class="stat-value">5</div>
                        <div class="stat-label">Late Arrivals</div>
                    </div>
                </div>

                <div class="row g-4">
                    <!-- Calendar View -->
                    <div class="col-lg-7">
                        <div class="card-cms">
                            <div class="card-header">
                                <h5 class="mb-0">December 2024</h5>
                                <div class="d-flex gap-2">
                                    <button class="btn-cms btn-ghost btn-sm"><i class="bi bi-chevron-left"></i></button>
                                    <button class="btn-cms btn-ghost btn-sm"><i
                                            class="bi bi-chevron-right"></i></button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="calendar-grid mb-3">
                                    <div class="calendar-day calendar-header">Sun</div>
                                    <div class="calendar-day calendar-header">Mon</div>
                                    <div class="calendar-day calendar-header">Tue</div>
                                    <div class="calendar-day calendar-header">Wed</div>
                                    <div class="calendar-day calendar-header">Thu</div>
                                    <div class="calendar-day calendar-header">Fri</div>
                                    <div class="calendar-day calendar-header">Sat</div>

                                    <div class="calendar-day holiday">1</div>
                                    <div class="calendar-day present">2</div>
                                    <div class="calendar-day present">3</div>
                                    <div class="calendar-day present">4</div>
                                    <div class="calendar-day absent">5</div>
                                    <div class="calendar-day present">6</div>
                                    <div class="calendar-day holiday">7</div>

                                    <div class="calendar-day holiday">8</div>
                                    <div class="calendar-day present">9</div>
                                    <div class="calendar-day late">10</div>
                                    <div class="calendar-day present">11</div>
                                    <div class="calendar-day present">12</div>
                                    <div class="calendar-day absent">13</div>
                                    <div class="calendar-day holiday">14</div>

                                    <div class="calendar-day holiday">15</div>
                                    <div class="calendar-day present">16</div>
                                    <div class="calendar-day present">17</div>
                                    <div class="calendar-day present">18</div>
                                    <div class="calendar-day present">19</div>
                                    <div class="calendar-day present">20</div>
                                    <div class="calendar-day holiday">21</div>

                                    <div class="calendar-day holiday">22</div>
                                    <div class="calendar-day present">23</div>
                                    <div class="calendar-day">24</div>
                                    <div class="calendar-day holiday">25</div>
                                    <div class="calendar-day empty">26</div>
                                    <div class="calendar-day empty">27</div>
                                    <div class="calendar-day empty">28</div>

                                    <div class="calendar-day empty">29</div>
                                    <div class="calendar-day empty">30</div>
                                    <div class="calendar-day empty">31</div>
                                </div>

                                <div class="d-flex gap-4 justify-content-center">
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="calendar-day present" style="width:24px;height:24px;"></div>
                                        <small>Present</small>
                                    </div>
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="calendar-day absent" style="width:24px;height:24px;"></div>
                                        <small>Absent</small>
                                    </div>
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="calendar-day late" style="width:24px;height:24px;"></div>
                                        <small>Late</small>
                                    </div>
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="calendar-day holiday" style="width:24px;height:24px;"></div>
                                        <small>Holiday</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Subject-wise -->
                    <div class="col-lg-5">
                        <div class="card-cms">
                            <div class="card-header">
                                <h5 class="mb-0">Subject-wise Attendance</h5>
                            </div>
                            <div class="card-body">
                                <div class="subject-attendance">
                                    <div class="d-flex justify-content-between mb-2">
                                        <strong>Programming Fundamentals</strong>
                                        <span class="badge-cms badge-success">83%</span>
                                    </div>
                                    <div class="progress-cms">
                                        <div class="progress-bar-cms success" style="width: 83%;"></div>
                                    </div>
                                    <small class="text-muted">20/24 classes</small>
                                </div>

                                <div class="subject-attendance" style="border-color: var(--success);">
                                    <div class="d-flex justify-content-between mb-2">
                                        <strong>Database Systems</strong>
                                        <span class="badge-cms badge-success">82%</span>
                                    </div>
                                    <div class="progress-cms">
                                        <div class="progress-bar-cms success" style="width: 82%;"></div>
                                    </div>
                                    <small class="text-muted">18/22 classes</small>
                                </div>

                                <div class="subject-attendance" style="border-color: var(--success);">
                                    <div class="d-flex justify-content-between mb-2">
                                        <strong>Web Development</strong>
                                        <span class="badge-cms badge-success">90%</span>
                                    </div>
                                    <div class="progress-cms">
                                        <div class="progress-bar-cms success" style="width: 90%;"></div>
                                    </div>
                                    <small class="text-muted">18/20 classes</small>
                                </div>

                                <div class="subject-attendance" style="border-color: var(--warning);">
                                    <div class="d-flex justify-content-between mb-2">
                                        <strong>Digital Logic Design</strong>
                                        <span class="badge-cms badge-warning">67%</span>
                                    </div>
                                    <div class="progress-cms">
                                        <div class="progress-bar-cms warning" style="width: 67%;"></div>
                                    </div>
                                    <small class="text-muted">12/18 classes</small>
                                </div>

                                <div class="subject-attendance" style="border-color: var(--warning);">
                                    <div class="d-flex justify-content-between mb-2">
                                        <strong>Mathematics</strong>
                                        <span class="badge-cms badge-warning">73%</span>
                                    </div>
                                    <div class="progress-cms">
                                        <div class="progress-bar-cms warning" style="width: 73%;"></div>
                                    </div>
                                    <small class="text-muted">16/22 classes</small>
                                </div>

                                <div class="alert-cms alert-warning mt-4">
                                    <i class="bi bi-exclamation-triangle"></i>
                                    <div>
                                        <strong>Warning!</strong>
                                        <p class="mb-0 fs-sm">2 subjects below 75%. Improve attendance to avoid
                                            detention.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../../js/auth.js"></script>
    <script>
        if (!protectPage(['student'])) { }
        const user = getCurrentUser();
        if (user) {
            const initials = user.name.split(' ').map(n => n[0]).join('').toUpperCase();
            document.getElementById('userName').textContent = user.name;
            document.getElementById('navUserName').textContent = user.name;
            document.querySelectorAll('#userAvatar, #navAvatar').forEach(el => el.textContent = initials);
        }
        document.getElementById('sidebarToggle').addEventListener('click', () => document.getElementById('sidebar').classList.toggle('collapsed'));
        document.querySelectorAll('.dropdown-cms').forEach(d => d.addEventListener('click', e => { e.stopPropagation(); d.classList.toggle('show'); }));
        document.addEventListener('click', () => document.querySelectorAll('.dropdown-cms').forEach(d => d.classList.remove('show')));
    </script>
</body>

</html>